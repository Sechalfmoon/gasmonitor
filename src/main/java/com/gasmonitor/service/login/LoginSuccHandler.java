package com.gasmonitor.service.login;import com.gasmonitor.dao.TenantRepository;import com.gasmonitor.entity.Tenant;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.security.core.Authentication;import org.springframework.security.web.authentication.AuthenticationSuccessHandler;import org.springframework.stereotype.Service;import javax.servlet.ServletException;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import javax.servlet.http.HttpSession;import java.io.IOException;/** * Created by saplmm on 2017/7/11. */@Servicepublic class LoginSuccHandler implements AuthenticationSuccessHandler {    private Logger logger = LoggerFactory.getLogger(LoginSuccHandler.class);    @Autowired    private TenantRepository tenantRepository;    @Override    public void onAuthenticationSuccess(            HttpServletRequest httpServletRequest,            HttpServletResponse httpServletResponse,            Authentication authentication) throws IOException, ServletException {        if (authentication == null) {            logger.info("onAuthenticationSuccess():authentication == null");        }        logger.info("登录成功之后 authentication.getName():{}", authentication.getName());        if (tenantRepository == null) {            logger.info("tenantRepository == null");        }        Tenant tenant = tenantRepository.findByName(authentication.getName());        HttpSession session = httpServletRequest.getSession();        session.setAttribute("authName", authentication.getName());        session.setAttribute("tenant", tenant);        logger.info("登录成功之后 authentication.getDetails():{}", authentication.getDetails());        logger.info("登录成功之后 authentication.getAuthorities():{}", authentication.getAuthorities());        logger.info("登录成功之后 session:{}", session);        logger.info("登录成功之后 session.getId():{}", session.getId());        httpServletResponse.sendRedirect("/index");    }}