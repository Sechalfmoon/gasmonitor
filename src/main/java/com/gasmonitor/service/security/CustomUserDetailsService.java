package com.gasmonitor.service.security;import com.gasmonitor.dao.TenantRepository;import com.gasmonitor.dao.UserRepository;import com.gasmonitor.entity.User;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.security.core.GrantedAuthority;import org.springframework.security.core.authority.SimpleGrantedAuthority;import org.springframework.security.core.userdetails.UserDetails;import org.springframework.security.core.userdetails.UserDetailsService;import org.springframework.security.core.userdetails.UsernameNotFoundException;import org.springframework.stereotype.Service;import java.util.ArrayList;import java.util.List;// * Created by saplmm on 2017/6/10.@Servicepublic class CustomUserDetailsService implements UserDetailsService {    private Logger log = LoggerFactory.getLogger(CustomUserDetailsService.class);    @Autowired    UserRepository userRepository;    @Autowired    TenantRepository tenantRepository;    @Override    public UserDetails loadUserByUsername(String s) throws UsernameNotFoundException {        return loadUserByName(s);//使用user表的用户数据    }    public UserDetails loadUserByName(String s) throws UsernameNotFoundException {        //数据库得到user的信息        User user = userRepository.findByUsername(s);        if (user == null) {            throw new UsernameNotFoundException("用户名错误");        }        //返回权限列表        List<GrantedAuthority> authorities = new ArrayList<GrantedAuthority>();        authorities.add(new SimpleGrantedAuthority(user.getRole()));        return new org.springframework.security.core.userdetails.User(user.getUsername(), user.getPassword(), authorities);    }}